(this["webpackJsonpthinc-live-coding"]=this["webpackJsonpthinc-live-coding"]||[]).push([[0],{20:function(e,t){},29:function(e,t,n){e.exports=n(47)},34:function(e,t,n){},41:function(e,t){},42:function(e,t){},43:function(e,t,n){},47:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(21),l=n.n(c),o=(n(34),n(12)),u=n(13),i=n.n(u),s=n(22),m=n(6),p=n(14),f=n.n(p),b=(n(43),n(28)),d=n(27),h=n(7),E=n(15),O=n(16),y=n(25),j=n(17);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(n,!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var g=function(e){return new Promise((function(t,n){var a=new FileReader;a.onload=function(e){var n=new Uint8Array(e.target.result),a=f.a.read(n,{type:"array"});t(a)},a.onerror=n,a.readAsArrayBuffer(e)}))},w=function(){var e=Object(a.useState)(""),t=Object(m.a)(e,2),n=(t[0],t[1],Object(a.useState)(0)),c=Object(m.a)(n,2),l=(c[0],c[1],Object(a.useState)()),u=Object(m.a)(l,2),p=u[0],v=u[1],w=Object(a.useState)(null),C=Object(m.a)(w,2),x=C[0],S=C[1],P=Object(a.useState)(null),A=Object(m.a)(P,2),D=A[0],R=A[1],I=Object(a.useState)(null),N=Object(m.a)(I,2),B=N[0],F=N[1],J=Object(a.useState)(""),W=Object(m.a)(J,2),_=W[0],z=W[1],T=Object(a.useRef)(null),U=Object(a.useCallback)((function(e){v(e[0])}),[]),V=Object(b.a)({onDrop:U,noClick:!1,accept:["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]}),$=V.getRootProps,q=V.getInputProps,G=(V.isDragActive,function(){var e=Object(s.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return e.next=3,g(t);case 3:n=e.sent,S(n),v(null);case 6:x&&1===Object.keys(x.Sheets).length&&H(Object.keys(x.Sheets)[0]);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),H=function(e){var t={},n=f.a.utils.sheet_to_json(x.Sheets[e]);Object.keys(n[0]).forEach((function(e){t[e]=!0})),F(t),R(n.map((function(e){return k({},e,{selected:!0})})))},K=function(e){R(D.map((function(t){return k({},t,{selected:e})})))},L=function(e){var t=D.map((function(t,n){return n===e?k({},t,{selected:!t.selected}):t}));R(t)};return r.a.createElement("div",{className:"App"},r.a.createElement(E.a,null,r.a.createElement("header",{className:"App-header"},r.a.createElement("h1",null,"Easy Reg"),r.a.createElement("h2",null,"Easily Export your excel data in any format"),r.a.createElement("div",Object.assign({className:"upload-zone"},$()),r.a.createElement("input",q()),r.a.createElement("p",null,"Choose your file here (It's not uploaded)"))),p&&r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,p.name),r.a.createElement("button",{onClick:function(){return G(p)}},"Read Excel!"))),r.a.createElement(E.a,null,r.a.createElement(y.a,null,x&&r.a.createElement(O.a,{md:D?4:12},r.a.createElement("h3",null,"Choose worksheet"),r.a.createElement(h.a,null,Object.keys(x.Sheets).map((function(e,t){return r.a.createElement(h.a.Item,{action:!0,key:"workbook-".concat(t),onClick:function(t){return H(e)}},e)}))),D&&r.a.createElement("div",null,r.a.createElement("h3",null,"Available Variables"),r.a.createElement(h.a,null,Object.keys(D[0]).map((function(e,t){return r.a.createElement(h.a.Item,{action:!0,onClick:function(t){z(_+"{".concat(e,"}"))},key:"sample-header-".concat(t)},e)}))),r.a.createElement("h4",null,"Type Format, replace variable with ","{<variable>}"),r.a.createElement("textarea",{value:_,onChange:function(e){return z(e.target.value)}}),r.a.createElement("h3",null,"Result"),r.a.createElement("small",null,"Click to copy"),r.a.createElement("textarea",{ref:T,value:D.filter((function(e){return e.selected})).map((function(e){return _.replace(/\{(.*?)\}/g,(function(t){var n=/\{(.*?)\}/g.exec(t)[1];return e[n]||"-"}))})).join("\n"),onClick:function(e){T.current.select(),document.execCommand("copy")},readOnly:!0}))),D&&r.a.createElement(O.a,{className:"scroll-wrapper"},r.a.createElement(j.a,{variant:"primary",onClick:function(){return K(!0)}},"Select All"),r.a.createElement(j.a,{variant:"danger",onClick:function(){return K(!1)}},"Deselect All"),r.a.createElement(d.a,null,r.a.createElement("thead",null,r.a.createElement("tr",null,Object.keys(D[0]).map((function(e,t){return r.a.createElement("th",{key:"h-".concat(t)},r.a.createElement("input",{type:"checkbox",checked:B[e],onChange:function(t){return F(k({},B,Object(o.a)({},e,!B[e])))}})," ",e)})))),r.a.createElement("tbody",null,D.map((function(e,t){return r.a.createElement("tr",{key:"r-".concat(t),className:e.selected?"selected":"",onClick:function(e){return L(t)}},Object.values(e).map((function(e,n){return r.a.createElement("td",{key:"r-".concat(t,"-c-").concat(n)},e)})))}))))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(46);l.a.render(r.a.createElement(w,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[29,1,2]]]);
//# sourceMappingURL=main.d5803945.chunk.js.map